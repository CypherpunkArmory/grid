---
- name: Does Vault-OpenVPN need to be installed?
  stat: path=/usr/local/bin/vault-openvpn
  register: vault_openvpn

- name: Install the Vault-OpenVPN utility
  when: not vault_openvpn.stat.exists
  block:
   - name: Get the Release
     get_url:
       url: "{{ vault_openvpn_url }}"
       dest: /tmp/vault-openvpn.tar.gz

   - name: Extract Binaries
     unarchive:
       src: /tmp/vault-openvpn.tar.gz
       dest: /usr/local/bin
       remote_src: yes

   - name: Rename Binary
     command: mv /usr/local/bin/vault-openvpn_linux_amd64 /usr/local/bin/vault-openvpn

   - name: Remove the download
     file:
       path: /tmp/vault-openvpn_linux_amd64.tar.gz
       state: absent
